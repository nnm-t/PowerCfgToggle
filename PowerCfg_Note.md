# `powercfg.exe` メモ

Author: Noname Kamisawa

## `powercfg.exe` とは

Windowsの **電源オプション** をコマンドライン上で操作するツール.

## 電源プランの一覧表示

`/l` スイッチを使う.

```bat
powercfg /l
```

こう出力される.

`<GUID>`, `<電源プラン名>` に任意の文字列が入るので, `grep` して取り出せば良い.
アクティブなプランには `*` が最後に付く.

```text
既存の電源設定 (* アクティブ)
-----------------------------------
電源設定の GUID: <GUID>  (<電源プラン名>) *
電源設定の GUID: <GUID>  (<電源プラン名>)
```

## 電源プランの変更

`/s` オプションを使う.

`<電源プラン名>` でも通る記事も見かけるが, 当環境では失敗した.
`<GUID>` で指定すると確実.

```bat
powercfg /s <GUID>
```

見つからない時は `パラメーターが無効です。 "/?" と入力してヘルプを表示して下さい。` と出力される.

## 参考

- [Windowsのpowercfg.exeコマンドで電源オプションの設定を変更する : Tech TIPS - @IT](https://www.atmarkit.co.jp/ait/articles/0804/25/news172.html)